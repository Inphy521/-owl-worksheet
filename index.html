<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²“é ­é·¹AIå‰µä½œå­¸ç¿’å–®</title>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #f0f1ff;
            --border-color: #ddd;
        }
        body { font-family: 'Microsoft JhengHei', sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; background: #f5f5f5; }
        .worksheet { background: white; padding: 40px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 3px solid var(--primary-color); padding-bottom: 20px; margin-bottom: 30px; }
        .header h1 { color: var(--primary-color); margin-bottom: 10px; }
        .info-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; padding: 15px; background: #f8f9fa; border-radius: 10px; }
        .info-item label { font-weight: bold; margin-right: 10px; }
        .info-item input { width: 100%; padding: 5px; border: none; border-bottom: 2px solid var(--primary-color); background: transparent; font-size: 16px; box-sizing: border-box; }
        .section { margin-bottom: 35px; padding: 20px; border-left: 5px solid var(--primary-color); background: var(--secondary-color); border-radius: 0 10px 10px 0; }
        .section-title { color: var(--primary-color); font-size: 1.5em; margin-bottom: 15px; }
        .question { margin-bottom: 25px; }
        .question-title { font-weight: bold; margin-bottom: 10px; color: #333; }
        .answer-box { background: white; border: 2px solid var(--border-color); border-radius: 8px; padding: 15px; min-height: 60px; }
        .checkbox-group { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px; }
        .checkbox-item { display: flex; align-items: center; background: white; padding: 10px; border-radius: 5px; border: 2px solid var(--border-color); }
        .checkbox-item input[type="checkbox"] { width: 20px; height: 20px; margin-right: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; }
        table td { padding: 10px; border: 2px solid var(--border-color); }
        table td:first-child { background: #f0f0f0; font-weight: bold; width: 30%; }
        .prompt-practice { background: white; border: 3px dashed var(--primary-color); padding: 20px; border-radius: 10px; margin-top: 15px; }
        #download-btn { display: block; width: 100%; padding: 15px; font-size: 18px; font-weight: bold; color: white; background-color: var(--primary-color); border: none; border-radius: 8px; cursor: pointer; margin-top: 30px; }
        #download-btn:hover { background-color: #5568d3; }
        /* New styles for teacher examples and student upload */
        .example-gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px; }
        .example-card { border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1); }
        .example-card img { width: 100%; height: auto; display: block; }
        .example-card p { padding: 10px; background-color: var(--secondary-color); color: var(--primary-color); font-size: 14px; margin: 0; font-family: monospace; }
        #image-preview { max-width: 100%; max-height: 400px; margin-top: 15px; border-radius: 8px; border: 2px dashed var(--border-color); display: none; }
        .custom-file-upload { border: 1px solid var(--primary-color); display: inline-block; padding: 8px 15px; cursor: pointer; background-color: var(--secondary-color); color: var(--primary-color); border-radius: 6px; font-weight: bold; }
        input[type="file"] { display: none; }
    </style>
</head>
<body>

<div class="worksheet">
    <div class="header">
        <h1>ğŸ¦‰ è²“é ­é·¹AIå‰µä½œå­¸ç¿’å–®</h1>
        <h2>èªè­˜è²“é ­é·¹èˆ‡AIåˆé«”é©—</h2>
    </div>

    <div class="info-section">
        <div class="info-item"><label>ç­ç´šï¼š</label><input type="text" id="student-class"></div>
        <div class="info-item"><label>åº§è™Ÿï¼š</label><input type="text" id="student-seat"></div>
        <div class="info-item"><label>å§“åï¼š</label><input type="text" id="student-name"></div>
    </div>

    <!-- Part 1: From original -->
    <div class="section">
        <div class="section-title">Part 1ï¼šèªè­˜è²“é ­é·¹</div>
        <div class="question">
            <div class="question-title">1. è²“é ­é·¹çš„ä¸‰å¤§ç”Ÿç‰©ç‰¹æ€§æ˜¯ä»€éº¼ï¼Ÿï¼ˆå¯è¤‡é¸ï¼‰</div>
            <div class="checkbox-group">
                <div class="checkbox-item"><input type="checkbox" id="q1-vision"><label for="q1-vision">ğŸ‘ï¸ æ•éŠ³çš„è¦–è¦º</label></div>
                <div class="checkbox-item"><input type="checkbox" id="q1-hearing"><label for="q1-hearing">ğŸ‘‚ è¶…å¼·çš„è½åŠ›</label></div>
                <div class="checkbox-item"><input type="checkbox" id="q1-flight"><label for="q1-flight">ğŸ”‡ éœéŸ³é£›è¡Œèƒ½åŠ›</label></div>
                <div class="checkbox-item"><input type="checkbox" id="q1-speed"><label for="q1-speed">âš¡ è¶…å¿«çš„é€Ÿåº¦</label></div>
            </div>
        </div>
        <div class="question">
            <div class="question-title">2. ä»€éº¼æ˜¯AIåœ–åƒç”Ÿæˆï¼Ÿï¼ˆç”¨è‡ªå·±çš„è©±èªªæ˜ï¼‰</div>
            <div class="answer-box" id="q2-what-is-ai" contenteditable="true"></div>
        </div>
    </div>

    <!-- Part 2: From original, with prompt guidance -->
    <div class="section">
        <div class="section-title">Part 2ï¼šAIåœ–åƒç”Ÿæˆåˆé«”é©—</div>
        <div class="question">
            <div class="question-title">3. æç¤ºè©çš„åŸºæœ¬æ¶æ§‹æ˜¯ä»€éº¼ï¼Ÿè«‹åƒè€ƒä»¥ä¸‹ç¯„ä¾‹ã€‚</div>
            <table><tr><td>æ¶æ§‹å…¬å¼</td><td id="q3-formula"><b>[ä¸»é¡Œ] + [ç´°ç¯€æè¿°] + [é¢¨æ ¼] + [å“è³ªèˆ‡åƒæ•¸]</b></td></tr></table>
            <div style="margin-top: 10px; padding: 10px; background: #e0e7ff; border-left: 4px solid #667eea; border-radius: 4px;">
                <strong>ç¯„ä¾‹ï¼š</strong><br>
                <b>[ä¸€éš»è²“é ­é·¹]</b> + <b>[é¾å…‹é ­ç«çˆ†ç´…è‰²é«®å‹çš„, ç«™åœ¨101å¤§æ¨“é ‚, èƒŒæ™¯æ˜¯æµæ˜Ÿé›¨]</b> + <b>[å‹•æ¼«é¢¨æ ¼]</b> + <b>[é«˜ç•«è³ª]</b>
            </div>
        </div>
        <div class="question">
            <div class="question-title">4. æç¤ºè©ç·´ç¿’ï¼šè«‹æ”¹å–„ã€Œè²“é ­é·¹ã€é€™å€‹æç¤ºè©</div>
            <div class="prompt-practice">
                <strong>âœ… æˆ‘æ”¹å–„å¾Œçš„æç¤ºè©ï¼š</strong>
                <div class="answer-box" id="q4-prompt-improve" contenteditable="true" style="margin-top: 10px;"></div>
            </div>
        </div>
    </div>

    <!-- Teacher's Examples (Updated) -->
    <div class="section">
        <div class="section-title">è€å¸«çš„ç¯„ä¾‹ (æç¤ºè©çµæ§‹åˆ†æ)</div>
        <div class="example-gallery">
            <div class="example-card">
                <img src="example-punk.png" alt="é¾å…‹é ­è²“é ­é·¹">
                <p><b>[ä¸€éš»è²“é ­é·¹]</b> + <b>[é¾å…‹é ­ç«çˆ†ç´…è‰²é«®å‹çš„, ç«™åœ¨101å¤§æ¨“é ‚, èƒŒæ™¯æ˜¯æµæ˜Ÿé›¨]</b> + <b>[å‹•æ¼«é¢¨æ ¼]</b> + <b>[é«˜ç•«è³ª]</b></p>
            </div>
            <div class="example-card">
                <img src="example-cartoon.png" alt="å¯æ„›è²“é ­é·¹æƒ…ä¾¶">
                <p><b>[ä¸€å°è²“é ­é·¹]</b> + <b>[æ©æ„›å½¢å½±ä¸é›¢, æœ‰è‘—åœ“æ»¾å¤§çœ¼ç›, ç«™åœ¨ä¸­å’Œåœ‹ä¸­çš„å¸ä»¤å°ä¸Š, èƒŒæ™¯æ˜¯å°å°å…µåœ˜]</b> + <b>[å¯æ„›å‹•ç•«é¢¨æ ¼]</b> + <b>[è‰²å½©é®®è±”]</b></p>
            </div>
        </div>
    </div>

    <!-- Recommended Tools (Final) -->
    <div class="section">
        <div class="section-title">å°ˆæ¥­AIç®—åœ–å·¥å…·æ¨è–¦</div>
        <p>å¦‚æœä½ æœ‰è‡ªå·±çš„å¸³è™Ÿï¼Œé€™äº›æ˜¯ç›®å‰æœ€ä¸»æµã€åŠŸèƒ½ä¹Ÿæœ€å¼·å¤§çš„å·¥å…·ï¼Œç”Ÿæˆçš„åœ–ç‰‡å“è³ªé€šå¸¸æ›´é«˜ã€‚</p>
        <ul style="list-style-type: disc; padding-left: 20px;">
            <li style="margin-bottom: 10px;">
                <a href="https://www.bing.com/images/create" target="_blank"><b>Bing Image Creator (Microsoft Copilot)</b></a><br>
                <b>ç‰¹è‰²ï¼š</b> æ•´åˆäº†æœ€æ–°çš„DALL-E 3æ¨¡å‹ï¼Œåœ–ç‰‡å“è³ªå’Œç´°ç¯€è™•ç†éå¸¸å‡ºè‰²ï¼Œå°¤å…¶æ“…é•·ç†è§£è¤‡é›œçš„å¥å­ã€‚ (éœ€ç™»å…¥ Microsoft å¸³è™Ÿ)
            </li>
            <li style="margin-bottom: 10px;">
                <a href="https://gemini.google.com/" target="_blank"><b>Google Gemini</b></a><br>
                <b>ç‰¹è‰²ï¼š</b> Googleå‡ºå“ï¼Œåœ–ç‰‡é¢¨æ ¼è¼ƒç‚ºçœŸå¯¦ã€ç²¾ç·»ï¼Œä¸”ç”Ÿæˆé€Ÿåº¦å¿«ï¼Œå¯é€éå°è©±ä¸æ–·ä¿®æ”¹ã€‚ (éœ€ç™»å…¥ Google å¸³è™Ÿ)
            </li>
            <li>
                <a href="https://chat.openai.com/" target="_blank"><b>ChatGPT (DALL-E 3)</b></a><br>
                <b>ç‰¹è‰²ï¼š</b> é€éã€Œå°è©±ã€çš„æ–¹å¼ç”Ÿæˆåœ–ç‰‡ï¼Œä½ å¯ä»¥åƒè·Ÿå®ƒèŠå¤©ä¸€æ¨£ï¼Œä¸æ–·æå‡ºä¿®æ”¹è¦æ±‚ï¼Œç›´åˆ°æ»¿æ„ç‚ºæ­¢ã€‚ (éœ€ç™»å…¥ OpenAI å¸³è™Ÿ)
            </li>
        </ul>
    </div>

    <!-- Part 3: From original -->
    <div class="section">
        <div class="section-title">Part 3ï¼šæˆ‘çš„è²“é ­é·¹å‰µæ„ä¼åŠƒ</div>
        <div class="question">
            <div class="question-title">5. æˆ‘çš„å‰µæ„æç¤ºè©è‰ç¨¿ (è«‹ä¾ç…§å››æ®µå¼æ¶æ§‹æ’°å¯«)</div>
            <div class="prompt-practice">
                <div class="answer-box" id="q5-prompt-draft" contenteditable="true" style="min-height: 150px;"></div>
            </div>
        </div>
    </div>

    <!-- Student's Work (Updated for 2 images) -->
    <div class="section">
        <div class="section-title">æˆ‘çš„ä½œå“</div>
        <p>è«‹ä¸Šå‚³ä½ æœ€æ»¿æ„çš„å…©å¼µä½œå“ï¼Œä¸¦åœ¨ä¸‹æ–¹è²¼ä¸Šä½ ä½¿ç”¨çš„æœ€çµ‚æç¤ºè©ã€‚</p>
        <div class="student-gallery" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px;">
            <!-- Student Upload 1 -->
            <div class="student-card" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; background: white;">
                <label for="image-uploader-1" class="custom-file-upload">ğŸ–¼ï¸ ä¸Šå‚³ä½œå“ 1</label>
                <input type="file" id="image-uploader-1" class="image-uploader" data-preview="image-preview-1" accept="image/*">
                <img id="image-preview-1" style="width: 100%; margin-top: 10px; display: none; border-radius: 6px;">
                <label for="prompt-final-1" style="margin-top: 10px; font-weight: bold;">ä½œå“1 çš„æç¤ºè©:</label>
                <textarea id="prompt-final-1" style="width: 100%; min-height: 80px; box-sizing: border-box; border: 1px solid var(--border-color);"></textarea>
            </div>
            <!-- Student Upload 2 -->
            <div class="student-card" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; background: white;">
                <label for="image-uploader-2" class="custom-file-upload">ğŸ–¼ï¸ ä¸Šå‚³ä½œå“ 2</label>
                <input type="file" id="image-uploader-2" class="image-uploader" data-preview="image-preview-2" accept="image/*">
                <img id="image-preview-2" style="width: 100%; margin-top: 10px; display: none; border-radius: 6px;">
                <label for="prompt-final-2" style="margin-top: 10px; font-weight: bold;">ä½œå“2 çš„æç¤ºè©:</label>
                <textarea id="prompt-final-2" style="width: 100%; min-height: 80px; box-sizing: border-box; border: 1px solid var(--border-color);"></textarea>
            </div>
        </div>
    </div>

    <!-- Self-assessment & Final Reflection (Updated) -->
    <div class="section">
        <div class="section-title">è‡ªæˆ‘è©•ä¼°èˆ‡èª²å¾Œçœæ€</div>
        <div class="question">
            <div class="question-title">æˆ‘å°æç¤ºè©çš„æŒæ¡åº¦ï¼š</div>
            <div class="checkbox-group" style="grid-template-columns: repeat(3, 1fr);">
                 <div class="checkbox-item"><input type="radio" name="rating" id="rating-good" value="good"><label for="rating-good">å¾ˆæœ‰ä¿¡å¿ƒ</label></div>
                 <div class="checkbox-item"><input type="radio" name="rating" id="rating-ok" value="ok"><label for="rating-ok">é‚„å¯ä»¥</label></div>
                 <div class="checkbox-item"><input type="radio" name="rating" id="rating-improve" value="improve"><label for="rating-improve">éœ€è¦åŠ å¼·</label></div>
            </div>
        </div>
        <div class="question">
            <div class="question-title">å°æ–¼ä»Šå¤©ä½¿ç”¨çš„AIç®—åœ–è»Ÿé«”ï¼Œä½ çš„æ„Ÿè¦ºæ˜¯ï¼Ÿ</div>
            <div class="checkbox-group" style="grid-template-columns: repeat(2, 1fr);">
                 <div class="checkbox-item"><input type="radio" name="tool-feeling" value="fun"><label for="tool-fun">éå¸¸æœ‰è¶£ï¼Œæˆ‘æƒ³å­¸æ›´å¤š</label></div>
                 <div class="checkbox-item"><input type="radio" name="tool-feeling" value="ok"><label for="tool-ok">é‚„ä¸éŒ¯ï¼Œä½†æœ‰é»è¤‡é›œ</label></div>
                 <div class="checkbox-item"><input type="radio" name="tool-feeling" value="soso"><label for="tool-soso">æ™®æ™®é€šé€šï¼Œæ²’ç‰¹åˆ¥æ„Ÿè¦º</label></div>
                 <div class="checkbox-item"><input type="radio" name="tool-feeling" value="bad"><label for="tool-bad">ä¸å¤ªå¥½ç”¨ï¼Œæœ‰é»æŒ«æŠ˜</label></div>
            </div>
        </div>
        <div class="question">
            <div class="question-title">åœ¨é€™å ‚èª²å¾Œï¼Œä½ å°è²“é ­é·¹çš„å°è±¡æ˜¯ä»€éº¼ï¼Ÿ</div>
             <div class="checkbox-group" style="grid-template-columns: repeat(2, 1fr);">
                 <div class="checkbox-item"><input type="radio" name="owl-impression" value="wisdom"><label for="owl-wisdom">æ™ºæ…§èˆ‡å®ˆè­·çš„è±¡å¾µ</label></div>
                 <div class="checkbox-item"><input type="radio" name="owl-impression" value="bird"><label for="owl-bird">å°±åªæ˜¯æ™®é€šçš„é³¥é¡</label></div>
                 <div class="checkbox-item"><input type="radio" name="owl-impression" value="diverse"><label for="owl-diverse">ä¸åŒåœ‹å®¶æœ‰ä¸åŒçœ‹æ³•ï¼Œå¾ˆæœ‰è¶£</label></div>
                 <div class="checkbox-item"><input type="radio" name="owl-impression" value="mysterious"><label for="owl-mysterious">æœ‰é»ç¥ç¥•ï¼Œç”šè‡³æœ‰é»å¯æ€•</label></div>
            </div>
        </div>
        <div class="question">
            <div class="question-title">èª²ç¨‹æé†’æˆ‘å€‘ï¼Œå¹³æ¿ã€é›»è…¦æ˜¯å¾ˆæ£’çš„å­¸ç¿’å·¥å…·ã€‚é™¤äº†ç©æ¨‚ï¼Œä½ é‚„å¯ä»¥ç”¨å®ƒä¾†åšä»€éº¼æœ‰æ„ç¾©çš„äº‹ï¼Ÿ</div>
            <div class="answer-box" id="q-meaningful-use" contenteditable="true"></div>
        </div>
        <div class="question">
            <div class="question-title">æƒ³åƒä¸€ä¸‹ï¼Œé™¤äº†ç•«åœ–ï¼ŒAIé‚„å¯ä»¥å¹«æˆ‘å€‘è§£æ±ºç”Ÿæ´»ä¸­çš„å“ªäº›å•é¡Œï¼Ÿ(è‡³å°‘å¯«å‡ºä¸€é …)</div>
            <div class="answer-box" id="q-ai-solution" contenteditable="true"></div>
        </div>
    </div>

    <button id="download-btn">æ‰“åŒ…ä¸¦ä¸‹è¼‰å­¸ç¿’å–®</button>
</div>

<script>
    // --- Setup variables and event listeners ---
    let uploadedImageBase64 = {
        img1: '',
        img2: ''
    };

    function setupUploader(uploaderId, previewId, storageKey) {
        const uploader = document.getElementById(uploaderId);
        const preview = document.getElementById(previewId);
        
        uploader.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImageBase64[storageKey] = e.target.result;
                preview.src = uploadedImageBase64[storageKey];
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        });
    }

    setupUploader('image-uploader-1', 'image-preview-1', 'img1');
    setupUploader('image-uploader-2', 'image-preview-2', 'img2');

    const downloadBtn = document.getElementById('download-btn');
    downloadBtn.addEventListener('click', () => {
        // --- 1. Gather all data from the form ---
        const studentInfo = {
            class: document.getElementById('student-class').value,
            seat: document.getElementById('student-seat').value,
            name: document.getElementById('student-name').value
        };

        if (!studentInfo.name || !studentInfo.class) {
            alert('è«‹å‹™å¿…å¡«å¯«ç­ç´šå’Œå§“åï¼');
            return;
        }

        const getRadioValue = (name) => {
            const radio = document.querySelector(`input[name="${name}"]:checked`);
            // Find the label associated with the radio button to get the text content
            return radio ? radio.parentElement.querySelector('label').textContent.trim() : 'ï¼ˆæœªé¸æ“‡ï¼‰';
        };

        const answers = {
            q1_vision: document.getElementById('q1-vision').checked,
            q1_hearing: document.getElementById('q1-hearing').checked,
            q1_flight: document.getElementById('q1-flight').checked,
            q1_speed: document.getElementById('q1-speed').checked,
            q2_what_is_ai: document.getElementById('q2-what-is-ai').innerHTML,
            q4_prompt_improve: document.getElementById('q4-prompt-improve').innerHTML,
            q5_prompt_draft: document.getElementById('q5-prompt-draft').innerHTML,
            rating: getRadioValue('rating'),
            tool_feeling: getRadioValue('tool-feeling'),
            owl_impression: getRadioValue('owl-impression'),
            meaningful_use: document.getElementById('q-meaningful-use').innerHTML,
            ai_solution: document.getElementById('q-ai-solution').innerHTML
        };
        
        const finalPrompts = {
            prompt1: document.getElementById('prompt-final-1').value,
            prompt2: document.getElementById('prompt-final-2').value
        };

        // --- 2. Generate the final HTML content ---
        const finalHtml = `
        <!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><title>${studentInfo.name} - å­¸ç¿’å–®</title>
        <style>
            body { font-family: Microsoft JhengHei, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
            .worksheet { max-width: 800px; margin: 20px auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
            h1, h2, h3, h4, h5 { color: #667eea; }
            .section { margin-bottom: 20px; padding: 15px; border-left: 4px solid #667eea; background: #f0f1ff; border-radius: 8px; }
            .answer, .prompt { background: #fff; padding: 10px; border-radius: 6px; border: 1px solid #ddd; white-space: pre-wrap; word-wrap: break-word; min-height: 20px; }
            img { max-width: 100%; border-radius: 8px; }
            ul { list-style: none; padding-left: 0; } li::before { content: "â˜‘ "; color: #667eea; } li.unchecked::before { content: "â˜ "; }
            .student-gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        </style>
        </head><body><div class="worksheet">
            <h1>ğŸ¦‰ ${studentInfo.name} çš„è²“é ­é·¹AIå‰µä½œå­¸ç¿’å–®</h1>
            <h3>ç­ç´š: ${studentInfo.class} | åº§è™Ÿ: ${studentInfo.seat}</h3>
            <div class="section"><h2>Part 1ï¼šèªè­˜è²“é ­é·¹</h2>
                <h4>1. è²“é ­é·¹çš„ä¸‰å¤§ç”Ÿç‰©ç‰¹æ€§æ˜¯ä»€éº¼ï¼Ÿ</h4>
                <ul>
                    <li class="${answers.q1_vision ? '' : 'unchecked'}">æ•éŠ³çš„è¦–è¦º</li>
                    <li class="${answers.q1_hearing ? '' : 'unchecked'}">è¶…å¼·çš„è½åŠ›</li>
                    <li class="${answers.q1_flight ? '' : 'unchecked'}">éœéŸ³é£›è¡Œèƒ½åŠ›</li>
                    <li class="${answers.q1_speed ? '' : 'unchecked'}">è¶…å¿«çš„é€Ÿåº¦</li>
                </ul>
                <h4>2. ä»€éº¼æ˜¯AIåœ–åƒç”Ÿæˆï¼Ÿ</h4><div class="answer">${answers.q2_what_is_ai || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
            </div>
            <div class="section"><h2>Part 2ï¼šAIåœ–åƒç”Ÿæˆåˆé«”é©—</h2>
                <h4>3. æç¤ºè©çš„åŸºæœ¬æ¶æ§‹æ˜¯ä»€éº¼ï¼Ÿ</h4><div class="answer"><b>[ä¸»é¡Œ] + [ç´°ç¯€æè¿°] + [é¢¨æ ¼] + [å“è³ªèˆ‡åƒæ•¸]</b></div>
                <h4>4. æˆ‘æ”¹å–„å¾Œçš„æç¤ºè©ï¼š</h4><div class="answer">${answers.q4_prompt_improve || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
            </div>
            <div class="section"><h2>Part 3ï¼šæˆ‘çš„è²“é ­é·¹å‰µæ„ä¼åŠƒ</h2>
                <h4>5. æˆ‘çš„å‰µæ„æç¤ºè©è‰ç¨¿ï¼š</h4><div class="answer">${answers.q5_prompt_draft || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
            </div>
            <div class="section"><h2>æˆ‘çš„ä½œå“</h2>
                <div class="student-gallery">
                    <div>
                        <h4>ä½œå“ 1</h4>
                        ${uploadedImageBase64.img1 ? `<img src="${uploadedImageBase64.img1}">` : '<div class="answer">ï¼ˆæœªä¸Šå‚³ï¼‰</div>'}
                        <h5>ä½œå“ 1 çš„æç¤ºè©:</h5>
                        <div class="prompt">${finalPrompts.prompt1 || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
                    </div>
                    <div>
                        <h4>ä½œå“ 2</h4>
                        ${uploadedImageBase64.img2 ? `<img src="${uploadedImageBase64.img2}">` : '<div class="answer">ï¼ˆæœªä¸Šå‚³ï¼‰</div>'}
                        <h5>ä½œå“ 2 çš„æç¤ºè©:</h5>
                        <div class="prompt">${finalPrompts.prompt2 || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
                    </div>
                </div>
            </div>
            <div class="section"><h2>è‡ªæˆ‘è©•ä¼°èˆ‡èª²å¾Œçœæ€</h2>
                <h4>æˆ‘å°æç¤ºè©çš„æŒæ¡åº¦ï¼š</h4><div class="answer">${answers.rating}</div>
                <h4>å°æ–¼ä»Šå¤©ä½¿ç”¨çš„AIç®—åœ–è»Ÿé«”ï¼Œä½ çš„æ„Ÿè¦ºæ˜¯ï¼Ÿ</h4><div class="answer">${answers.tool_feeling}</div>
                <h4>åœ¨é€™å ‚èª²å¾Œï¼Œä½ å°è²“é ­é·¹çš„å°è±¡æ˜¯ä»€éº¼ï¼Ÿ</h4><div class="answer">${answers.owl_impression}</div>
                <h4>é™¤äº†ç©æ¨‚ï¼Œæˆ‘é‚„å¯ä»¥ç”¨å¹³æ¿/é›»è…¦åšé€™äº›æœ‰æ„ç¾©çš„äº‹ï¼š</h4><div class="answer">${answers.meaningful_use || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
                <h4>æˆ‘æƒ³åƒAIé‚„å¯ä»¥å¹«æˆ‘å€‘è§£æ±ºé€™äº›å•é¡Œï¼š</h4><div class="answer">${answers.ai_solution || 'ï¼ˆæœªå¡«å¯«ï¼‰'}</div>
            </div>
        </div></body></html>`;

        // --- 3. Create and trigger download ---
        const blob = new Blob([finalHtml], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${studentInfo.class}_${studentInfo.seat}_${studentInfo.name}_è²“é ­é·¹å­¸ç¿’å–®.html`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    });
</script>

</body>
</html>